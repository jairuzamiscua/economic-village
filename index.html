<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EconoVille - Agrarian Economy Simulator</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Top Bar - Strategic Overview -->
<div class="top-bar">
  <div class="game-title">EconoVille: Agrarian Era</div>
  
  <div class="resource-bar">
    <div class="resource-item">
      <span class="resource-icon">üë•</span>
      <span class="resource-value" id="topPop">80</span>/<span id="topCap">100</span>
    </div>
    <div class="resource-item">
      <span class="resource-icon">üåæ</span>
      <span class="resource-value" id="topFood">20</span>
    </div>
    <div class="resource-item">
      <span class="resource-icon">ü™µ</span>
      <span class="resource-value" id="topMat">30</span>
    </div>
    <div class="resource-item">
      <span class="resource-icon">üìÖ</span>
      <span class="resource-value"><span id="topSeason">Spring</span> <span id="topYear">1</span></span>
    </div>
  </div>
  
  <div class="game-controls">
    <button class="btn-icon" id="btnPause">‚è∏</button>
    <select class="btn-icon" id="speedSelect">
      <option value="2000">1x</option>
      <option value="1000">2x</option>
      <option value="500">4x</option>
    </select>
    <button class="btn-icon" id="btnSave">Save</button>
    <button class="btn-icon" id="btnMenu">Menu</button>
  </div>
</div>

<!-- Main 3-Column Layout -->
<div class="main-container">
  
  <!-- LEFT PANEL - Production & Labor -->
  <aside class="panel panel-left">
    
    <!-- Labor Allocation -->
    <div class="section">
      <div class="section-header" data-section="labor">
        <span class="section-title">‚öí Labor Allocation</span>
        <span class="section-toggle">‚ñº</span>
      </div>
      <div class="section-content expanded" id="labor-content">
        <div class="slider-row">
          <div class="slider-label">
            <span>Farmers</span>
            <span class="slider-value" id="farmerPct">50%</span>
          </div>
          <input type="range" min="0" max="100" value="50" id="farmerSlider"/>
          <div class="stat-detail">Base food production</div>
        </div>
        
        <div class="slider-row">
          <div class="slider-label">
            <span>Builders</span>
            <span class="slider-value" id="builderPct">30%</span>
          </div>
          <input type="range" min="0" max="100" value="30" id="builderSlider"/>
          <div class="stat-detail">Construction speed</div>
        </div>
        
        <div class="slider-row">
          <div class="slider-label">
            <span>Gatherers</span>
            <span class="slider-value" id="gathererPct">10%</span>
          </div>
          <input type="range" min="0" max="100" value="10" id="gathererSlider"/>
          <div class="stat-detail">Resource harvesting</div>
        </div>
        
        <div class="slider-row">
          <div class="slider-label">
            <span>Herders</span>
            <span class="slider-value" id="herderPct">10%</span>
          </div>
          <input type="range" min="0" max="100" value="10" id="herderSlider"/>
          <div class="stat-detail">Livestock management</div>
        </div>
        
        <div class="divider"></div>
        
        <div class="slider-row">
          <div class="slider-label">
            <span>Work Intensity</span>
            <span class="slider-value" id="intensityPct">100%</span>
          </div>
          <input type="range" min="50" max="150" value="100" id="intensitySlider"/>
          <div class="stat-detail">‚ö† Higher = lower morale</div>
        </div>
        
        <div class="info-row">
          <span class="info-label">Idle Workers:</span>
          <span class="info-value" id="idlePct">0%</span>
        </div>
        
        <div class="divider"></div>
        
        <div class="info-row">
          <span class="info-label">Labor Efficiency:</span>
          <span class="info-value" id="laborEfficiency">100%</span>
        </div>
        <div class="stat-detail">Skills adjust slowly when reallocating</div>
      </div>
    </div>
    
    <!-- Agricultural Management -->
    <div class="section">
      <div class="section-header" data-section="agriculture">
        <span class="section-title">üåæ Agriculture</span>
        <span class="section-toggle">‚ñº</span>
      </div>
      <div class="section-content expanded" id="agriculture-content">
        <div class="info-row">
          <span class="info-label">Soil Quality:</span>
          <span class="info-value" id="soilQuality">100%</span>
        </div>
        <div class="info-row">
          <span class="info-label">Active Farms:</span>
          <span class="info-value" id="activeFarms">0</span>
        </div>
        <div class="info-row">
          <span class="info-label">Food/Day:</span>
          <span class="info-value" id="foodProduction">0.0</span>
        </div>
        
        <div class="subsection-title">Default Crop</div>
        <div class="crop-grid">
          <div class="crop-option active" data-crop="wheat">
            <div class="crop-name">Wheat</div>
            <div class="crop-stats">High yield</div>
          </div>
          <div class="crop-option" data-crop="rye">
            <div class="crop-name">Rye</div>
            <div class="crop-stats">Hardy</div>
          </div>
          <div class="crop-option" data-crop="barley">
            <div class="crop-name">Barley</div>
            <div class="crop-stats">Fast</div>
          </div>
          <div class="crop-option" data-crop="legumes">
            <div class="crop-name">Legumes</div>
            <div class="crop-stats">Soil+</div>
          </div>
        </div>
        
        <div class="subsection-title">Land Policy</div>
        <button class="btn-policy" id="btnPolicy">Commons (Equal Access)</button>
        <div class="stat-detail">Enclosure = gradual consolidation</div>
        
        <div class="divider"></div>
        
        <div id="enclosureInfo"></div>
        
        <div class="divider"></div>
        
        <div class="subsection-title">Farm Overview</div>
        <div id="farmListContent" class="farm-list"></div>
      </div>
    </div>
    
    <!-- Construction -->
    <div class="section">
      <div class="section-header" data-section="buildings">
        <span class="section-title">üèó Construction</span>
        <span class="section-toggle">‚ñº</span>
      </div>
      <div class="section-content expanded" id="buildings-content">
        <div class="build-palette" id="buildPalette"></div>
        
        <div class="construction-queue" id="constructionQueue" style="display:none">
          <div class="subsection-title">Under Construction</div>
          <div id="queueList"></div>
        </div>
      </div>
    </div>
    
    <!-- Technology -->
    <div class="section">
      <div class="section-header" data-section="tech">
        <span class="section-title">‚öó Technology</span>
        <span class="section-toggle">‚ñº</span>
      </div>
      <div class="section-content" id="tech-content">
        <button class="btn-primary" id="btnTechTree">Open Tech Tree</button>
        <div class="info-row" style="margin-top: 8px">
          <span class="info-label">Unlocked:</span>
          <span class="info-value" id="techCount">1</span>
        </div>
      </div>
    </div>
    
  </aside>
  
  <!-- CENTER PANEL - Map View -->
  <section class="map-container">
    <div class="map-hud">
      <div class="hud-badge">
        <span id="weatherIcon">‚òÄÔ∏è</span>
        <span id="weatherNow">Sunny</span>
      </div>
      <div class="hud-badge">
        Real Wage: <strong id="hudWage">1.0</strong>
      </div>
    </div>
    
    <!-- Season Banner -->
    <div class="season-banner" id="seasonBanner">
      <div class="season-icon" id="seasonIcon">üå±</div>
      <div class="season-info">
        <div class="season-name" id="seasonName">Spring</div>
        <div class="season-desc" id="seasonDesc">Planting season</div>
        <div class="season-progress">Day <span id="seasonDay">1</span>/90</div>
      </div>
    </div>
    
    <div class="ground" id="ground"></div>
    
    <div class="minimap">
      <div style="padding: 8px; font-size: 10px; color: #5a6578;">
        Minimap (placeholder)
      </div>
    </div>
  </section>
  
  <!-- RIGHT PANEL - Statistics & Indicators -->
  <aside class="panel panel-right">
    
    <!-- Tabs -->
    <div class="tabs">
      <div class="tab active" data-tab="economy">Economy</div>
      <div class="tab" data-tab="society">Society</div>
      <div class="tab" data-tab="stats">Statistics</div>
    </div>
    
    <!-- Economy Tab -->
    <div class="tab-content active" id="economy-tab">
      
      <div class="section">
        <div class="section-header" data-section="indicators">
          <span class="section-title">üìä Economic Indicators</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="indicators-content">
          
          <div class="meter-box">
            <div class="meter-header">
              <span>Real Wage</span>
              <span class="meter-value" id="wageValue">1.0</span>
            </div>
            <div class="meter-bar">
              <div class="meter-fill" id="wageFill" style="width: 50%"></div>
            </div>
            <div class="meter-desc">Malthusian indicator</div>
          </div>
          
          <div class="meter-box">
            <div class="meter-header">
              <span>Food Security</span>
              <span class="meter-value" id="foodDays">0d</span>
            </div>
            <div class="meter-bar">
              <div class="meter-fill" id="foodFill" style="width: 0%"></div>
            </div>
            <div class="meter-desc">Days of food stored</div>
          </div>
          
          <div class="meter-box">
            <div class="meter-header">
              <span>Health</span>
              <span class="meter-value" id="healthValue">60%</span>
            </div>
            <div class="meter-bar">
              <div class="meter-fill green" id="healthFill" style="width: 60%"></div>
            </div>
            <div class="meter-desc">Disease risk: <span id="diseaseRisk">1%</span></div>
          </div>
          
          <div class="meter-box">
            <div class="meter-header">
              <span>Morale</span>
              <span class="meter-value" id="moraleValue">60%</span>
            </div>
            <div class="meter-bar">
              <div class="meter-fill" id="moraleFill" style="width: 60%"></div>
            </div>
            <div class="meter-desc">Affects productivity</div>
          </div>
          
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="resources">
          <span class="section-title">üí∞ Resources</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="resources-content">
          <div class="info-row">
            <span class="info-label">Food Stock:</span>
            <span class="info-value" id="foodStock">20</span>
          </div>
          <div class="info-row">
            <span class="info-label">Materials:</span>
            <span class="info-value" id="materials">30</span>
          </div>
          <div class="info-row">
            <span class="info-label">Livestock:</span>
            <span class="info-value" id="livestock">0</span>
          </div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="trade">
          <span class="section-title">üè™ Trade</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content" id="trade-content">
          <div id="tradeInfo">
            <div class="stat-detail">Build a market to enable trade</div>
          </div>
        </div>
      </div>
      
    </div>
    
    <!-- Society Tab -->
    <div class="tab-content" id="society-tab">
      
      <div class="section">
        <div class="section-header" data-section="population">
          <span class="section-title">üë• Population</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="population-content">
          <div class="info-row">
            <span class="info-label">Total Population:</span>
            <span class="info-value" id="population">80</span>
          </div>
          <div class="info-row">
            <span class="info-label">Capacity:</span>
            <span class="info-value" id="capacity">100</span>
          </div>
          <div class="info-row">
            <span class="info-label">Total Deaths:</span>
            <span class="info-value" id="totalDeaths">0</span>
          </div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="social">
          <span class="section-title">‚öñ Social Structure</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="social-content">
          <div class="info-row">
            <span class="info-label">Freeholders:</span>
            <span class="info-value">20%</span>
          </div>
          <div class="info-row">
            <span class="info-label">Villeins:</span>
            <span class="info-value">60%</span>
          </div>
          <div class="info-row">
            <span class="info-label">Cottars:</span>
            <span class="info-value">20%</span>
          </div>
          <div class="divider"></div>
          <div class="info-row">
            <span class="info-label">Lord's Tithe:</span>
            <span class="info-value" id="lordTithe">40%</span>
          </div>
          <div class="info-row">
            <span class="info-label">Church Tithe:</span>
            <span class="info-value">10%</span>
          </div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="urban">
          <span class="section-title">üèõ Urbanization</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content" id="urban-content">
          <div id="urbanInfo"></div>
        </div>
      </div>
      
    </div>
    
    <!-- Stats Tab -->
    <div class="tab-content" id="stats-tab">
      
      <div class="section">
        <div class="section-header" data-section="theory">
          <span class="section-title">üìö Economic Theory</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="theory-content">
          <div class="theory-status" id="theoryStatus">Malthusian Trap</div>
          <div class="stat-detail" id="theoryDesc">Population pressure keeps wages at subsistence</div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="victory">
          <span class="section-title">üèÜ Victory Progress</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="victory-content">
          <div class="progress-bar">
            <div class="progress-fill" id="victoryFill" style="width: 0%">0%</div>
          </div>
          <div class="stat-detail" style="margin-top: 8px">Complete milestones to advance</div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-header" data-section="log">
          <span class="section-title">üìú Game Log</span>
          <span class="section-toggle">‚ñº</span>
        </div>
        <div class="section-content expanded" id="log-content">
          <div class="game-log" id="gameLog">Time flows when you interact...</div>
        </div>
      </div>
      
    </div>
    
  </aside>
  
</div>

<!-- MODALS -->

<!-- Tech Tree Modal -->
<div class="modal" id="techModal">
  <div class="modal-overlay"></div>
  <div class="modal-content tech-modal">
    <div class="modal-header">
      <h2>Technology Tree - Agrarian Era</h2>
      <button class="modal-close" id="techClose">√ó</button>
    </div>
    <div class="modal-body">
      <div class="tech-tree-container" id="techTreeContainer"></div>
    </div>
  </div>
</div>

<!-- Crop Selection Modal -->
<div class="modal" id="cropModal">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="cropModalTitle">Select Crop for Farm</h2>
      <button class="modal-close" id="cropClose">√ó</button>
    </div>
    <div class="modal-body">
      <div class="crop-modal-grid" id="cropGrid"></div>
      <div style="margin-top: 16px; display: flex; justify-content: space-between; align-items: center;">
        <label style="font-size: 11px; display: flex; gap: 8px; align-items: center;">
          <input type="checkbox" id="setDefaultCrop">
          Set as default for new farms
        </label>
        <button class="btn-secondary" id="cropCancel">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Farm Info Modal -->
<div class="modal" id="farmInfoModal">
  <div class="modal-overlay"></div>
  <div class="modal-content farm-modal">
    <div class="modal-header">
      <h2 id="farmInfoTitle">Farm Info</h2>
      <button class="modal-close" onclick="hideModal('farmInfoModal')">√ó</button>
    </div>
    <div class="modal-body">
      <div id="farmInfoBody"></div>
      <div class="farm-actions">
        <button class="btn-primary" id="farmInfoHarvest" style="display:none">üåæ Harvest Now</button>
        <button class="btn-primary" id="farmInfoPlant" style="display:none">üå± Plant Crop</button>
      </div>
    </div>
  </div>
</div>

<!-- Event Card -->
<div class="modal" id="eventModal">
  <div class="modal-overlay"></div>
  <div class="modal-content event-modal">
    <div class="modal-header">
      <h2 id="eventTitle">Event</h2>
    </div>
    <div class="modal-body">
      <p id="eventDesc" class="event-desc"></p>
      <div class="event-effect" id="eventEffect"></div>
      <div class="event-buttons">
        <button class="btn-primary" id="eventAccept">Accept</button>
        <button class="btn-secondary" id="eventDecline">Decline</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script src="game.js"></script>
</body>
</html>