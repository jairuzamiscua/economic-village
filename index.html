<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Macroeconomic Reasoning Panel</title>
<style>
  :root{
    --ink:#0f172a; --muted:#475569; --line:#e2e8f0; --bg:#ffffff;
    --accent:#1e3a8a; --accent-2:#2563eb; --soft:#f8fafc; --good:#065f46; --bad:#7f1d1d;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--soft);color:var(--ink);font:16px/1.5 system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:980px;margin:24px auto;padding:16px}
  /* Card */
  .card{background:var(--bg);border:1px solid var(--line);border-radius:12px;box-shadow:0 2px 10px rgba(2,6,23,.05);overflow:hidden}
  .card header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 16px;background:linear-gradient(180deg,#eef2ff,#ffffff)}
  .card h2{margin:0;font-size:1.05rem;font-weight:800;color:var(--accent)}
  .row{display:flex;flex-wrap:wrap;gap:10px}
  /* Controls */
  .controls{padding:12px 16px;border-top:1px solid var(--line);display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .controls .field{display:flex;flex-direction:column;gap:6px}
  label{font-size:.85rem;font-weight:700;color:var(--muted)}
  select,button{border:1px solid var(--line);border-radius:10px;padding:8px 10px;background:#fff}
  select{font-weight:600}
  .btn{cursor:pointer;font-weight:700}
  .btn.primary{background:var(--accent-2);border-color:var(--accent-2);color:#fff}
  .btn.ghost{background:#fff;color:var(--accent-2)}
  .utils{display:flex;gap:8px;align-items:center}
  /* Content */
  .content{padding:16px;display:grid;gap:14px}
  .eyebrow{font-size:.78rem;color:#475569;text-transform:uppercase;letter-spacing:.08em}
  .analysis, .chain, .eval, .sources{border:1px dashed var(--line);border-radius:10px;padding:12px;background:#fff}
  .analysis p{margin:.4rem 0}
  .chain-list{margin:.2rem 0 .2rem 0;padding-left:0;list-style:none;display:grid;gap:8px}
  .chain-list li{position:relative;padding-left:28px}
  .chain-list li::before{
    content:"→"; position:absolute;left:6px;color:var(--accent-2);font-weight:900
  }
  .chip{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--line);background:#f8fafc;font-size:.78rem;color:#334155}
  /* Toggle grid */
  .toggles{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px;margin-top:2px}
  .toggle{border:1px solid var(--line);border-radius:10px;background:#fff}
  .toggle summary{
    cursor:pointer;list-style:none;padding:8px 10px;font-weight:800;color:#0f172a;
    display:flex;align-items:center;justify-content:space-between
  }
  .toggle summary::-webkit-details-marker {display:none}
  .toggle .body{padding:0 10px 10px 10px;color:#111827}
  .good{color:var(--good);font-weight:700}
  .bad{color:var(--bad);font-weight:700}
  /* Sources */
  .sources .list{display:grid;gap:6px;margin-top:8px}
  .tag{display:inline-grid;place-items:center;width:20px;height:20px;border:1px solid var(--accent-2);color:var(--accent-2);border-radius:6px;font-weight:800;font-size:.78rem;margin-right:6px}
  .source a{color:var(--accent-2);text-decoration:none}
  .source a:hover{text-decoration:underline}
  .muted{color:#64748b}
  /* Helpers */
  .hidden{display:none}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace}
  @media (max-width:720px){ .controls{grid-template-columns:1fr} }
</style>
</head>
<body>
  <div class="wrap">
    <section id="reasoning-panel" class="card" aria-label="Macroeconomic reasoning panel">
      <header>
        <div>
          <div class="eyebrow">Reasoning Panel</div>
          <h2>Exam-style Analysis + Evaluation</h2>
        </div>
        <div class="utils">
          <button class="btn ghost" id="copyBtn" title="Copy analysis + evaluation">Copy</button>
          <button class="btn primary" id="refreshBtn" title="Rebuild with current options">Rebuild</button>
        </div>
      </header>

      <!-- Controls -->
      <div class="controls">
        <div class="field">
          <label for="policy">Policy / Shock</label>
          <select id="policy">
            <option value="raise_rate">Raise interest rates (monetary tightening)</option>
            <option value="cut_rate">Cut interest rates (monetary easing)</option>
            <option value="fiscal_stimulus">Fiscal stimulus (govt spending ↑)</option>
            <option value="vat_cut">VAT cut / indirect tax reduction</option>
            <option value="currency_depreciation">Currency depreciation</option>
            <option value="wage_subsidy">Wage subsidy / hiring credit</option>
            <option value="qe">Quantitative easing (QE)</option>
            <option value="oil_shock">Negative supply shock (oil price ↑)</option>
          </select>
        </div>
        <div class="field">
          <label for="size">Size of change</label>
          <select id="size">
            <option value="small">Small</option>
            <option value="medium" selected>Medium</option>
            <option value="large">Large</option>
          </select>
        </div>
        <div class="field">
          <label for="confidence">Consumer/firm confidence</label>
          <select id="confidence">
            <option value="low">Low (pessimistic)</option>
            <option value="neutral" selected>Neutral</option>
            <option value="high">High (optimistic)</option>
          </select>
        </div>
        <div class="field">
          <label for="slack">Slack vs capacity (output gap)</label>
          <select id="slack">
            <option value="negative">Negative gap (recessionary)</option>
            <option value="zero" selected>Near potential</option>
            <option value="positive">Positive gap (overheating)</option>
          </select>
        </div>
      </div>

      <!-- Generated content -->
      <div class="content" id="content">
        <section class="analysis" id="analysis">
          <div class="eyebrow">Analysis</div>
          <p class="lead" id="analysis-lead"></p>
          <ul class="chain-list" id="chain"></ul>
          <p id="linkback" class="muted"></p>
        </section>

        <section class="chain" id="secondary">
          <div class="eyebrow">Chain Effects (models)</div>
          <div class="row" id="modelsRow"></div>
        </section>

        <section class="eval" id="evaluation">
          <div class="eyebrow">Evaluation (toggle)</div>
          <div class="toggles" id="evalToggles"></div>
        </section>

        <section class="sources" id="sources">
          <div class="eyebrow">References</div>
          <details id="sourcesDetails">
            <summary class="row" style="justify-content:space-between;align-items:center;padding:6px 0;cursor:pointer">
              <span>Open sources & explainers</span>
              <span class="chip">click to expand</span>
            </summary>
            <div class="list" id="sourceList"></div>
          </details>
        </section>
      </div>
    </section>
  </div>

<script>
/** ------------------------------
 *  Data: concise, student-friendly blocks
 *  ------------------------------ */
const SOURCES = [
  {tag:'1', label:'EconomicsHelp – Interest rates & AD/AS', url:'https://www.economicshelp.org/macroeconomics/monetary-policy/effect-interest-rates/'},
  {tag:'2', label:'Bank of England – How interest rates work', url:'https://www.bankofengland.co.uk/monetary-policy/how-does-monetary-policy-work'},
  {tag:'3', label:'St. Louis Fed – Phillips Curve explainer', url:'https://www.stlouisfed.org/open-vault/2020/january/what-is-phillips-curve-why-flattened'},
  {tag:'4', label:'Cleveland Fed – Okun’s Law overview', url:'https://www.clevelandfed.org/publications/economic-commentary/2012/ec-201208-an-unstable-okuns-law-not-the-best-rule-of-thumb'},
  {tag:'5', label:'Atlanta Fed – Taylor Rule', url:'https://www.atlantafed.org/cqer/research/taylor-rule'},
  {tag:'6', label:'ECB – Automatic stabilisers', url:'https://www.ecb.europa.eu/press/economic-bulletin/articles/2020/html/ecb.ebart202006_03~3175750a6d.en.html'},
  {tag:'7', label:'EconomicsHelp – Fiscal policy', url:'https://www.economicshelp.org/macroeconomics/fiscal-policy/'},
  {tag:'8', label:'Bank of England – QE explained', url:'https://www.bankofengland.co.uk/monetary-policy/quantitative-easing'},
  {tag:'9', label:'EconomicsHelp – Exchange rates', url:'https://www.economicshelp.org/macroeconomics/exchangerate/'}
];

// Template snippets per policy
const POLICIES = {
  raise_rate: {
    title: 'Raise interest rates',
    lead: size =>
      `Higher policy rates increase borrowing costs and reward saving. Households and firms cut interest-sensitive spending; aggregate demand ${sizeAdj(size,'falls slightly','falls','falls sharply')}.`,
    chain: [
      'Bank lending and mortgages become more expensive → credit demand drops',
      'Consumption of durables and investment projects are postponed',
      'Aggregate demand (AD) shifts left → real GDP growth slows',
      'Lower demand pressures reduce cost-push passthrough over time'
    ],
    models: (ctx)=>[
      {label:'Phillips curve', text:`Slower growth widens slack → reduces inflationary pressure ${tag('3')}.`},
      {label:'Okun’s law', text:`Weaker GDP growth tends to raise unemployment ${tag('4')}.`},
      {label:'Taylor rule', text:`In overheating, rule recommends higher rates; near potential, smaller move ${tag('5')}.`}
    ],
    eval: (ctx)=>([
      {
        head:'Strengths vs Limitations',
        body:`${strong('Strength:')} effective against demand-pull inflation and de-anchors expectations risk.
              ${weak('Limitation:')} blunt tool; weak on pure supply shocks (e.g. oil).`
      },
      {
        head:'Short-term vs Long-term',
        body:`Short-term: slower growth and rising unemployment risk.
              Long-term: price stability can anchor expectations and support sustainable growth.`
      },
      {
        head:'Winners vs Losers',
        body:`Savers gain from higher deposit returns; leveraged borrowers face higher repayments (mortgages, SMEs).`
      },
      {
        head:'Depends on…',
        body:`Effect is ${ctx.confidence==='low'?'stronger when confidence is already weak':'smaller when confidence is high'}; transmission depends on mortgage types/fix rates and global conditions.`
      }
    ]),
    linkback:'See: EconomicsHelp on rates ' + tag('1') + ' and BoE explainer ' + tag('2') + '.'
  },

  cut_rate: {
    title: 'Cut interest rates',
    lead: size =>
      `Lower policy rates reduce borrowing costs and the reward to saving. This boosts interest-sensitive spending; aggregate demand ${sizeAdj(size,'rises a little','rises','rises strongly')}.`,
    chain: [
      'Cheaper credit → mortgages & business loans more affordable',
      'Consumption of durables and private investment pick up',
      'AD shifts right → real GDP growth increases',
      'If slack remains, inflation pressures stay contained'
    ],
    models: (ctx)=>[
      {label:'Phillips curve', text:`Closing the output gap can lift inflation toward target ${tag('3')}.`},
      {label:'Okun’s law', text:`Stronger growth can reduce unemployment ${tag('4')}.`}
    ],
    eval:(ctx)=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} quick demand support.
        ${weak('Limitation:')} weak when confidence is very low or at the lower bound.`},
      {head:'Short vs Long', body:`Short: growth/jobs support. Long: risk of asset froth & debt vulnerability.`},
      {head:'Winners vs Losers', body:`Borrowers benefit; savers see lower returns.`},
      {head:'Depends on…', body:`Bank pass-through, fixed-rate share, and global shocks.`}
    ],
    linkback:'See: EconomicsHelp on rates ' + tag('1') + ', BoE explainer ' + tag('2') + '.'
  },

  fiscal_stimulus: {
    title: 'Fiscal stimulus (spending ↑)',
    lead: size =>
      `Higher government spending injects demand directly into the economy. Via the multiplier, aggregate demand ${sizeAdj(size,'edges up','rises','rises strongly')}, especially when there is spare capacity.`,
    chain: [
      'Public outlays (infrastructure, services) increase incomes',
      'Multiplier effects lift private consumption and investment',
      'AD shifts right → higher real GDP and employment',
      'If near capacity, inflationary pressure may build'
    ],
    models:(ctx)=>[
      {label:'Automatic stabilisers', text:`In downturns, existing benefits/taxes already cushion demand ${tag('6')}; discretionary spending adds extra support.`}
    ],
    eval:(ctx)=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} precise targeting (e.g., shovel-ready projects).
        ${weak('Limitation:')} implementation lags; crowding-out risk when at capacity.`},
      {head:'Short vs Long', body:`Short: strong boost when gap is negative.
        Long: debt sustainability and taxation trade-offs.`},
      {head:'Winners vs Losers', body:`Construction & suppliers gain; future taxpayers may bear servicing costs.`},
      {head:'Depends on…', body:`Size of multiplier (confidence, openness, slack) and supply bottlenecks.`}
    ],
    linkback:'See: EconomicsHelp on fiscal policy ' + tag('7') + '.'
  },

  vat_cut: {
    title: 'VAT cut / indirect tax reduction',
    lead: size =>
      `Cutting VAT lowers consumer prices, raising real disposable income. Demand ${sizeAdj(size,'nudges up','rises','jumps')}, especially for price-sensitive goods.`,
    chain: [
      'Lower prices → real incomes increase',
      'Consumption rises, particularly for elastic categories',
      'AD shifts right → output and employment increase',
      'Headline inflation may fall initially (level effect)'
    ],
    models:()=>[
      {label:'Phillips curve nuance', text:`Lower measured inflation from a one-off VAT cut is a level shift, not a lasting fall in inflation pressure ${tag('3')}.`}
    ],
    eval:()=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} fast pass-through at tills.
        ${weak('Limitation:')} firms may not pass 100% through; temporary effects.`},
      {head:'Short vs Long', body:`Short: demand support and lower CPI.
        Long: fiscal cost; effect fades once VAT reverts.`},
      {head:'Winners vs Losers', body:`Consumers benefit; govt revenue falls.`},
      {head:'Depends on…', body:`Market competition (pass-through) and expectations.`}
    ],
    linkback:'See: EconomicsHelp on indirect taxes ' + tag('7') + '.'
  },

  currency_depreciation: {
    title: 'Currency depreciation',
    lead: size =>
      `A weaker currency makes exports cheaper and imports dearer. Net exports improve; aggregate demand ${sizeAdj(size,'rises a touch','rises','rises strongly')}, but imported-cost inflation can increase.`,
    chain: [
      'Export volumes up (price competitiveness)',
      'Import spending falls / switches to domestic goods',
      'AD shifts right via (X−M)',
      'Imported inflation raises CPI until pass-through fades'
    ],
    models:()=>[
      {label:'Open-economy AD/AS', text:`Demand boost vs cost-push trade-off (terms of trade).`}
    ],
    eval:()=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} boosts tradeables sector.
        ${weak('Limitation:')} raises imported inflation; effect weaker if supply chains are import-intensive.`},
      {head:'Short vs Long', body:`Short: CPI pass-through.
        Long: competitiveness improves if firms invest/productivity rises.`},
      {head:'Winners vs Losers', body:`Exporters and tourism gain; importers and consumers of tradables lose.`},
      {head:'Depends on…', body:`Elasticities, pass-through, and global demand.`}
    ],
    linkback:'See: EconomicsHelp on exchange rates ' + tag('9') + '.'
  },

  wage_subsidy: {
    title: 'Wage subsidy / hiring credit',
    lead: size =>
      `A temporary subsidy reduces effective labour costs, encouraging hiring and retention. Employment ${sizeAdj(size,'edges up','rises','rises strongly')} and incomes support spending.`,
    chain: [
      'Lower labour cost → more vacancies filled',
      'Household incomes rise → consumption increases',
      'AD shifts right; unemployment falls',
      'Fiscal cost accrues while scheme runs'
    ],
    models:()=>[
      {label:'Okun’s law (employment link)', text:`Direct support to jobs strengthens the growth-jobs relationship ${tag('4')}.`}
    ],
    eval:()=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} targets labour market directly.
        ${weak('Limitation:')} deadweight risk (paying for jobs that would exist anyway).`},
      {head:'Short vs Long', body:`Short: prevents scarring.
        Long: if temporary, effects fade; if permanent, fiscal cost.`},
      {head:'Winners vs Losers', body:`Job seekers and SMEs gain; taxpayers fund the scheme.`},
      {head:'Depends on…', body:`Design details, targeting, and administrative capacity.`}
    ],
    linkback:'See: EconomicsHelp on labour markets and policy ' + tag('7') + '.'
  },

  qe: {
    title: 'Quantitative easing (QE)',
    lead: size =>
      `Central bank asset purchases push down long-term yields and support asset prices. Financial conditions ease; aggregate demand ${sizeAdj(size,'ticks up','rises','rises notably')}.`,
    chain: [
      'Bond yields fall → cheaper long-term borrowing',
      'Portfolio rebalancing → asset prices & wealth effects',
      'AD shifts right; inflation expectations supported',
      'Exit strategy later matters for stability'
    ],
    models:()=>[
      {label:'Transmission', text:`Term-premium, expectations, and balance-sheet channels; complements policy rate near lower bound.`}
    ],
    eval:()=>[
      {head:'Strengths vs Limits', body:`${strong('Strength:')} works when rates near zero.
        ${weak('Limitation:')} distributional/asset-price concerns; uncertain potency.`},
      {head:'Short vs Long', body:`Short: supports demand and inflation expectations.
        Long: unwind risks; market distortions if prolonged.`},
      {head:'Winners vs Losers', body:`Asset holders benefit; renters/new buyers face higher prices.`},
      {head:'Depends on…', body:`Scale, composition, and communication credibility.`}
    ],
    linkback:'See: BoE QE explainer ' + tag('8') + '.'
  },

  oil_shock: {
    title: 'Negative supply shock (oil ↑)',
    lead: size =>
      `A sharp rise in energy costs shifts short-run aggregate supply left. Output growth ${sizeAdj(size,'slows slightly','slows','falls')}, while inflation rises (stagflation risk).`,
    chain: [
      'Firms’ costs increase → prices rise and output trimmed',
      'Real incomes fall as consumer energy bills rise',
      'SRAS shifts left; output down, inflation up',
      'Policy trade-off between growth and inflation'
    ],
    models:()=>[
      {label:'Phillips curve caveat', text:`Supply shocks push inflation up even with weak demand ${tag('3')}.`}
    ],
    eval:()=>[
      {head:'Strengths vs Limits', body:`${weak('Limitation:')} demand tools (rates) can’t fix the supply root; can only cool knock-on inflation.`},
      {head:'Short vs Long', body:`Short: real income squeeze.
        Long: adjustment via efficiency, diversification, alternative energy.`},
      {head:'Winners vs Losers', body:`Energy producers gain; energy-intensive sectors and low-income households lose.`},
      {head:'Depends on…', body:`Duration of shock and wage-price dynamics.`}
    ],
    linkback:'See: EconomicsHelp – cost-push inflation ' + tag('1') + '.'
  }
};

/** ------------------------------
 * Helpers
 * ------------------------------ */
function sizeAdj(size, small, med, large){
  return size==='small'?small : size==='large'?large : med;
}
function strong(s){ return `<span class="good">${s}</span>`; }
function weak(s){ return `<span class="bad">${s}</span>`; }
function tag(t){ return `<span class="tag">${t}</span>`; }

function contextFromUI(){
  return {
    policy: document.getElementById('policy').value,
    size: document.getElementById('size').value,
    confidence: document.getElementById('confidence').value,
    slack: document.getElementById('slack').value
  };
}

/** ------------------------------
 * Render
 * ------------------------------ */
function renderPanel(){
  const ctx = contextFromUI();
  const spec = POLICIES[ctx.policy];
  if(!spec) return;

  // Analysis lead
  const lead = spec.lead(ctx.size);
  document.getElementById('analysis-lead').innerHTML =
    `<strong>Point:</strong> ${lead}`;

  // Chain list (cause → effect → wider effect)
  const chain = spec.chain.map(s=>`<li>${s}</li>`).join('');
  document.getElementById('chain').innerHTML = chain;

  // Link-back sentence
  document.getElementById('linkback').innerHTML = spec.linkback;

  // Models/chain-effects chips
  const modelsRow = document.getElementById('modelsRow');
  modelsRow.innerHTML = '';
  (spec.models(ctx) || []).forEach(m=>{
    const box = document.createElement('div');
    box.className = 'chip';
    box.title = m.label;
    box.innerHTML = `<span class="mono">${m.label}:</span> ${m.text}`;
    modelsRow.appendChild(box);
  });

  // Evaluation toggles
  const evalWrap = document.getElementById('evalToggles');
  evalWrap.innerHTML = '';
  (spec.eval(ctx) || []).forEach((blk,i)=>{
    const det = document.createElement('details');
    det.className = 'toggle';
    det.innerHTML = `
      <summary>${blk.head}<span class="chip">toggle</span></summary>
      <div class="body"><p>${blk.body}</p>
        <p class="muted" style="margin:.4rem 0 0">Tip: Always end with a judgment (depends on confidence, slack, and external shocks).</p>
      </div>`;
    // Open the first toggle by default for clarity
    if(i===0) det.setAttribute('open','open');
    evalWrap.appendChild(det);
  });
}

/** ------------------------------
 * Sources list & copy
 * ------------------------------ */
function renderSources(){
  const list = document.getElementById('sourceList');
  list.innerHTML = '';
  SOURCES.forEach(s=>{
    const row = document.createElement('div');
    row.className = 'source';
    row.innerHTML = `${tag(s.tag)} <a href="${s.url}" target="_blank" rel="noopener">${s.label}</a>`;
    list.appendChild(row);
  });
}

function copyToClipboard(){
  // Assemble clean text (analysis + chain + one open evaluation block)
  const lead = stripHTML(document.getElementById('analysis-lead').innerHTML);
  const chainItems = [...document.querySelectorAll('#chain li')].map(li=>`→ ${stripHTML(li.innerHTML)}`).join('\n');
  const openEval = document.querySelector('.toggle[open] .body');
  const evalText = openEval ? stripHTML(openEval.textContent.trim()) : '';
  const judgment = 'Judgment: Impact size depends on confidence, size of change, and slack (output gap).';
  const out = `Analysis:\n${lead}\n\nChain of Reasoning:\n${chainItems}\n\nEvaluation (selected):\n${evalText}\n\n${judgment}`;
  navigator.clipboard.writeText(out).then(()=>{
    notify('Copied analysis + evaluation to clipboard.');
  });
}

function stripHTML(html){ const tmp=document.createElement('div'); tmp.innerHTML=html; return tmp.textContent||tmp.innerText||''; }
function notify(msg){
  const b = document.getElementById('copyBtn');
  const old = b.textContent;
  b.textContent = 'Copied ✓';
  setTimeout(()=>{ b.textContent = old; }, 1300);
}

/** ------------------------------
 * Wire-up
 * ------------------------------ */
document.getElementById('policy').addEventListener('change', renderPanel);
document.getElementById('size').addEventListener('change', renderPanel);
document.getElementById('confidence').addEventListener('change', renderPanel);
document.getElementById('slack').addEventListener('change', renderPanel);
document.getElementById('refreshBtn').addEventListener('click', renderPanel);
document.getElementById('copyBtn').addEventListener('click', copyToClipboard);

renderSources();
renderPanel();
</script>
</body>
</html>
